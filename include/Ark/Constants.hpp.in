/**
 * @file Constants.hpp
 * @author Alexandre Plateau (lexplt.dev@gmail.com)
 * @brief Constants used by ArkScript
 * @version 0.2
 * @date 2020-10-27
 *
 * @copyright Copyright (c) 2020-2024
 *
 */

#ifndef INCLUDE_ARK_CONSTANTS_HPP_IN
#define INCLUDE_ARK_CONSTANTS_HPP_IN

#include <string_view>

// clang-format off
constexpr int ARK_VERSION_MAJOR = @ARK_VERSION_MAJOR@;
constexpr int ARK_VERSION_MINOR = @ARK_VERSION_MINOR@;
constexpr int ARK_VERSION_PATCH = @ARK_VERSION_PATCH@;
// clang-format on
constexpr std::string_view ARK_VERSION { "@ARK_VERSION_MAJOR@.@ARK_VERSION_MINOR@.@ARK_VERSION_PATCH@" };
constexpr std::string_view ARK_FULL_VERSION { "@ARK_VERSION_MAJOR@.@ARK_VERSION_MINOR@.@ARK_VERSION_PATCH@-@ARK_COMMIT@" };

#define ARK_COMPILER "@CMAKE_CXX_COMPILER_ID@"
#define ARK_CACHE_DIRNAME "__arkscript__"
#define ARK_NO_NAME_FILE "FILE"

#if defined(_WIN32) || defined(_WIN64)
#    define ARK_PLATFORM_NAME "Windows"
#elif defined(__APPLE__) || defined(__MACH__)
#    define ARK_PLATFORM_NAME "Mac OSX"
#elif defined(__linux__)
#    define ARK_PLATFORM_NAME "Linux"
#elif defined(__FreeBSD__)
#    define ARK_PLATFORM_NAME "FreeBSD"
#elif defined(__unix) || defined(__unix__)
#    define ARK_PLATFORM_NAME "Unix"
#else
#    define ARK_PLATFORM_NAME "Other"
#endif

#include <cinttypes>
#include <cstddef>

namespace Ark
{
    // Compiler options
    constexpr uint16_t FeatureImportSolver   = 1 << 0;
    constexpr uint16_t FeatureMacroProcessor = 1 << 1;
    constexpr uint16_t FeatureASTOptimizer   = 1 << 2;
    constexpr uint16_t FeatureTestFailOnException = 1 << 15;

    // Default features for the VM x Compiler x Parser
    constexpr uint16_t DefaultFeatures = FeatureImportSolver | FeatureMacroProcessor | FeatureASTOptimizer;

    constexpr std::size_t MaxMacroProcessingDepth = 256;  ///< Controls the number of recursive calls to MacroProcessor::processNode
    constexpr std::size_t MaxMacroUnificationDepth = 256;  ///< Controls the number of recursive calls to MacroProcessor::unify
    constexpr std::size_t VMStackSize = 8192;
}

#endif
